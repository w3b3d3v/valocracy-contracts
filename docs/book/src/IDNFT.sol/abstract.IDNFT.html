<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>IDNFT</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../book.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../../index.html">Home</a></li><li class="chapter-item expanded "><a href="../../src/IDNFT.sol/abstract.IDNFT.html" class="active">IDNFT</a></li><li class="chapter-item "><a href="../../src/Treasury.sol/contract.Treasury.html">Treasury</a></li><li class="chapter-item "><a href="../../src/interfaces/IIDNFT.sol/interface.IIDNFT.html">IIDNFT</a></li><li class="chapter-item "><a href="../../src/interfaces/ITreasury.sol/interface.ITreasury.html">ITreasury</a></li><li class="chapter-item "><a href="../../testing/TreasuryTestCoverage.html">Treasury Test Coverage</a></li><li class="chapter-item "><a href="../../testing/TreasuryTestScenarios.html">Treasury Test Scenarios</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/w3b3d3v/valocracy-contracts" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="idnft"><a class="header" href="#idnft">IDNFT</a></h1>
<p><a href="https://github.com/w3b3d3v/valocracy-contracts/blob/3c1bb3a5dbf1b0852bacbc7957066c674b876a74/src/IDNFT.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="/src/math/ERC7725.sol/abstract.ERC7725.html">ERC7725</a></p>
<p><strong>Author:</strong>
0xneves</p>
<p>This contract provides a gamefied system for tracking account's progress and their respectful energy eficiency.
Character progress is known as the account's <code>Level</code> and energy as their <code>Mana</code>. Addresses health bar is their reputation
record, it's immortal and will always live on the blockchain but the Level can fluctuate deppending on the amount of Mana.
Level can be used to quantify that user's ability to change the world around them but Mana controls how much efficient
that Level is. On a spectrum, full Mana symbolizes 100% of the user Level but 0% Mana resets the user Level to 0.
Game Rules:</p>
<ul>
<li>Implementors should decide how their users gain new levels</li>
<li>Mana is measured as unix timestamp and is considered full while: Mana + <a href="/src/IDNFT.sol/abstract.IDNFT.html#stableperiod">stablePeriod</a> &gt; block.timestamp</li>
<li>Mana is replenished every time the user Level increases.</li>
<li>Stable period and decreasing period resets to default every time the user Level increases.</li>
<li>Decreasing period always start counting after stable period ends.</li>
<li>Level lost by the lack of Mana cannot be replenished.</li>
</ul>
<p>*Implementers of IDNFT should configure the desired mechanics or override with their own. The standard version deliver
the Level value, that can be used for decision making in the ecosystem and Mana for downgrading the Level based on the
user activity.
Requirements:</p>
<ul>
<li>The contract requires stable period and the decreasing period to function but their values can be override.</li>
<li>The contract relies on ERC-7725 for exponential curve decay, but another logic can override the behaviour.*</li>
</ul>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="_accounts"><a class="header" href="#_accounts">_accounts</a></h3>
<p>Mapping from accounts addresses to their Level and Mana</p>
<pre><code class="language-solidity">mapping(address =&gt; Character) private _accounts;
</code></pre>
<h3 id="_curvature"><a class="header" href="#_curvature">_curvature</a></h3>
<p>Curvature of the resulting decay value</p>
<pre><code class="language-solidity">int16 private _curvature;
</code></pre>
<h3 id="_stableperiod"><a class="header" href="#_stableperiod">_stablePeriod</a></h3>
<p>Configuration of the active and inactive time of users</p>
<pre><code class="language-solidity">uint32 private _stablePeriod;
</code></pre>
<h3 id="_decreaseperiod"><a class="header" href="#_decreaseperiod">_decreasePeriod</a></h3>
<pre><code class="language-solidity">uint32 private _decreasePeriod;
</code></pre>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="curvature"><a class="header" href="#curvature">curvature</a></h3>
<p><em>The curvature for calculating the Level decay.</em></p>
<pre><code class="language-solidity">function curvature() public view virtual returns (int16);
</code></pre>
<h3 id="stableperiod"><a class="header" href="#stableperiod">stablePeriod</a></h3>
<p><em>Amount of time while the Mana is stable and won't be consumed.</em></p>
<pre><code class="language-solidity">function stablePeriod() public view virtual returns (uint32);
</code></pre>
<h3 id="decreaseperiod"><a class="header" href="#decreaseperiod">decreasePeriod</a></h3>
<p><em>Amount of time it takes from Mana stability until its full depletion.</em></p>
<pre><code class="language-solidity">function decreasePeriod() public view virtual returns (uint32);
</code></pre>
<h3 id="accountstats"><a class="header" href="#accountstats">accountStats</a></h3>
<p><em>Returns the raw <code>Character</code> settings of <code>account</code> with no adjustments.</em></p>
<pre><code class="language-solidity">function accountStats(address account) public view virtual returns (Character memory);
</code></pre>
<h3 id="levelof"><a class="header" href="#levelof">levelOf</a></h3>
<p><em>Returns the Level of a given <code>account</code> adjusted for his current Mana.</em></p>
<pre><code class="language-solidity">function levelOf(address account) public view virtual returns (uint256);
</code></pre>
<h3 id="_increaselevel"><a class="header" href="#_increaselevel">_increaseLevel</a></h3>
<p><em>Increases the current Level of <code>account</code> by <code>amount</code> and replenishes the Mana.</em></p>
<pre><code class="language-solidity">function _increaseLevel(address account, uint256 amount) internal virtual;
</code></pre>
<h3 id="_setcurvature"><a class="header" href="#_setcurvature">_setCurvature</a></h3>
<p><em>Set a new curvature</em></p>
<pre><code class="language-solidity">function _setCurvature(int16 curvature_) internal virtual;
</code></pre>
<h3 id="_setstableperiod"><a class="header" href="#_setstableperiod">_setStablePeriod</a></h3>
<p><em>Set a new stable period</em></p>
<pre><code class="language-solidity">function _setStablePeriod(uint32 stablePeriod_) internal virtual;
</code></pre>
<h3 id="_setdecreaseperiod"><a class="header" href="#_setdecreaseperiod">_setdecreasePeriod</a></h3>
<p><em>Set a new decreasing period</em></p>
<pre><code class="language-solidity">function _setdecreasePeriod(uint32 decreasePeriod_) internal virtual;
</code></pre>
<h3 id="__unsafe_setlevelandmana"><a class="header" href="#__unsafe_setlevelandmana">__unsafe_setLevelAndMana</a></h3>
<p><em>Unsafe write access to an account Character.
WARNING: Anyone calling this MUST ensure that the custom implementation matches the expected behaviour of the contract.</em></p>
<pre><code class="language-solidity">function __unsafe_setLevelAndMana(address account, uint256 amount, uint32 mana) internal;
</code></pre>
<h2 id="structs"><a class="header" href="#structs">Structs</a></h2>
<h3 id="character"><a class="header" href="#character">Character</a></h3>
<p>Character progress</p>
<pre><code class="language-solidity">struct Character {
    uint256 level;
    uint32 mana;
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../src/Treasury.sol/contract.Treasury.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../src/Treasury.sol/contract.Treasury.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../solidity.min.js"></script>


    </div>
    </body>
</html>
